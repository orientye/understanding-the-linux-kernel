:toc:
:toclevels: 5
:hardbreaks-option:

== 初始化

▪ 通知链(Notification Chains)
大多数内核子系统是相互独立的，因此某个子系统可能对其它子系统产生的事件感兴趣。为了满足这个需求，也即是让某个子系统在发生某个事件时通知其它的子系统，内核提供了通知链的机制。通知链表只能够在内核的子系统之间使用，不能够在内核与用户空间之间进行事件通知。通知链表是一个函数链表，链表上的每一个节点都注册了一个函数。当某个事情发生时，根据优先级，链表上所有节点对应的函数就会被执行。

struct notifier_block
https://elixir.bootlin.com/linux/latest/source/include/linux/notifier.h
https://elixir.bootlin.com/linux/latest/source/kernel/notifier.c

▪ 网络设备初始化
net_dev_init()
https://elixir.bootlin.com/linux/latest/source/net/core/dev.c

    struct softnet_data
        https://elixir.bootlin.com/linux/latest/source/include/linux/netdevice.h
        struct softnet_data每个CPU一个
    open_softirq(NET_TX_SOFTIRQ, net_tx_action);
    open_softirq(NET_RX_SOFTIRQ, net_rx_action);

▪ PCI层和网络接口卡
ISA PCI PCI-e

▪ 组件初始化的内核基础架构
netdev_boot_setup()
https://elixir.bootlin.com/linux/latest/source/net/core/dev.c

▪ 设备注册和初始化
xxx_setup
例如Ethernet设备的ether_setup(): https://elixir.bootlin.com/linux/latest/source/net/ethernet/eth.c