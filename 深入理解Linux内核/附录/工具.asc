:toc:
:toclevels: 5
:hardbreaks-option:

== 工具

=== 源码

==== 离线
▪ linux: vim + gtags; vscode
▪ mac: understand; vscode
▪ windows: understand; vscode

▪ vscode

=== 在线
▪ https://elixir.bootlin.com/linux/latest/source

=== 文档
▪ https://github.com/torvalds/linux/tree/master/Documentation
    
    github上看rst格式的文档比较友好

▪ https://docs.kernel.org/index.html

▪ https://www.kernel.org/doc/html/latest/

▪ https://lwn.net/
▪ https://lwn.net/Kernel/Index/

▪ https://lkml.org/

    邮件讨论与订阅

=== 书籍
▪ 早期内核:
《Linux内核完全剖析》  0.12
《Linux内核设计的艺术》  0.11

▪ 经典内核:
《Linux内核设计与实现》Linux Kernel Development, 3rd Edition(LKD) 2.6.34
《深入理解Linux内核》Understanding the Linux Kernel, 3rd Edition(ULK) 2.6.11
《深入Linux内核架构》Professional Linux Kernel Architecture(LKA)  2.6.24
《Linux内核源代码情景分析》 2.4.0

▪ 专题:
《深入理解Linux虚拟内存管理》 2.4.22
《深入理解Linux网络技术内幕》
《Linux设备驱动程序》第三版
《Embedded Linux Primer》
《Essential Linux Device Drivers》

=== 编译
编译选项: O2(默认)/Os
O2针对性能，Os针对大小
内核依赖O2/Os级别来优化，不要选择O0/O1/O3级别

[source, c]
.https://elixir.bootlin.com/linux/latest/source/init/Kconfig
----
choice
	prompt "Compiler optimization level"
	default CC_OPTIMIZE_FOR_PERFORMANCE

config CC_OPTIMIZE_FOR_PERFORMANCE
	bool "Optimize for performance (-O2)"
	help
	  This is the default optimization level for the kernel, building
	  with the "-O2" compiler flag for best performance and most
	  helpful compile-time warnings.

config CC_OPTIMIZE_FOR_SIZE
	bool "Optimize for size (-Os)"
	help
	  Choosing this option will pass "-Os" to your compiler resulting
	  in a smaller kernel.

endchoice
----

[source, c]
.https://elixir.bootlin.com/linux/latest/source/Makefile
----
    ifdef CONFIG_CC_OPTIMIZE_FOR_PERFORMANCE
    KBUILD_CFLAGS += -O2
    else ifdef CONFIG_CC_OPTIMIZE_FOR_SIZE
    KBUILD_CFLAGS += -Os
    endif
----

=== 调试
▪ QEMU + gdb
▪ kgdb
▪ OpenOCD(Open On-Chip Debugger)
▪ https://zhuanlan.zhihu.com/p/34511018
▪ https://www.kernel.org/doc/html/latest/dev-tools/gdb-kernel-debugging.html
▪ https://blog.csdn.net/gatieme/article/details/68948080
▪ crash

=== 开发
https://www.kernel.org/doc/html/latest/dev-tools/index.html

=== 配置
▪ 查看ubuntu操作系统的kernel config:

    orient@my-ubuntu:~$ ls /boot/config-`uname -r`
    /boot/config-5.15.0-53-generic
    orient@my-ubuntu:~$ vi /boot/config-5.15.0-53-generic

=== 测试
==== 单元测试
https://kernel.org/doc/html/latest/dev-tools/kunit/index.html

==== 性能测试
LTP
stress
BCC

https://lwn.net/Kernel/Index/#Benchmarking

=== 代码

==== 风格
https://www.kernel.org/doc/html/latest/process/coding-style.html
https://www.kernel.org/doc/html/v5.0/translations/zh_CN/coding-style.html