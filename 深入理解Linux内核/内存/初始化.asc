:toc:
:toclevels: 5
:hardbreaks-option:

== 初始化

=== 整体流程
https://elixir.bootlin.com/linux/latest/source/init/main.c
流程:

    start_kernel
        setup_arch(&command_line);
        setup_per_cpu_areas();
        build_all_zonelists(NULL);
        page_alloc_init();
        mm_init();
        kmem_cache_init_late();
        setup_per_cpu_pageset();

=== node初始化
对于UMA，内核将其视为NUMA node0
可以在启动后，使用sudo dmesg | grep NUMA查看相关初始化信息。

流程:
    setup_arch() https://elixir.bootlin.com/linux/latest/source/arch/x86/kernel/setup.c
        initmem_init()
            #ifndef CONFIG_NUMA https://elixir.bootlin.com/linux/latest/source/arch/x86/mm/init_64.c
            否则 x86_numa_init() https://elixir.bootlin.com/linux/latest/source/arch/x86/mm/numa_64.c
                numa_init(): https://elixir.bootlin.com/linux/latest/source/arch/x86/mm/numa.c
