:toc:
:toclevels: 5
:hardbreaks-option:

== 字符设备

=== 结构
[source,c]
.https://elixir.bootlin.com/linux/latest/source/include/linux/cdev.h
----
struct cdev {
	struct kobject kobj;
	struct module *owner;
	const struct file_operations *ops;
	struct list_head list;
	dev_t dev;
	unsigned int count;
} __randomize_layout;
----

/dev/null:  struct file_operations null_fops
https://elixir.bootlin.com/linux/latest/source/drivers/char/mem.c

=== 简单字符设备
以空设备/dev/null为例:
[source,c]
.https://elixir.bootlin.com/linux/latest/source/include/uapi/linux/major.h
----
#define MEM_MAJOR		1
----

=== console
https://elixir.bootlin.com/linux/latest/source/drivers/video/console
https://elixir.bootlin.com/linux/latest/source/drivers/video/fbdev

https://elixir.bootlin.com/linux/latest/source/include/linux/console_struct.h
https://elixir.bootlin.com/linux/latest/source/drivers/tty/vt/vt.c
    con_write(）
        do_con_write()

v0.12:
https://elixir.bootlin.com/linux/0.12/source/kernel/chr_drv/console.c
